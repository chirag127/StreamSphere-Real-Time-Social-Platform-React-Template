name: CI

# Trigger the workflow on push events to the main branch and on pull request events
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# Define a set of reusable jobs
jobs:
  build-and-test:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [20.x] # Specify the Node.js version for consistency

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Setup Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v4
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm' # Cache npm dependencies for faster builds

    - name: Install Dependencies
      run: npm ci # Use 'ci' for cleaner, deterministic installs in CI environments

    - name: Lint and Format (Biome)
      run: npx @biomejs/biome check --apply . # Automatically apply formatting and fix linting issues

    - name: Run Vitest (Unit & Integration Tests)
      run: npm test # Execute test script defined in package.json

    # Example for E2E tests with Playwright (if applicable, uncomment and configure)
    # - name: Install Playwright Browsers
    #   run: npx playwright install
    # - name: Run Playwright E2E Tests
    #   run: npm run e2e # Assuming an 'e2e' script in package.json

    # Example for code coverage upload (if using a service like Codecov or Coveralls)
    # - name: Upload Coverage Reports
    #   uses: codecov/codecov-action@v4 # Replace with your chosen coverage service
    #   with:
    #     token: ${{ secrets.CODECOV_TOKEN }} # Ensure you have this secret configured

    # NOTE: For a React template focused on Frontend, unit and linting are primary.
    # E2E tests and coverage are often added as the project matures.
    # This CI ensures basic code quality and functionality.
